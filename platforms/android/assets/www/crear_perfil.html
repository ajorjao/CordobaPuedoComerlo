<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>crear perfil</title>
	<link href="css/bootstrap.min.css"  rel="stylesheet">
    <link href="css/style.css"  rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js" "></script>
    <script type="text/javascript">
    	// var url_server = "localhost:3000"
      // var url_server = "10.6.43.164:3000"
      var url_server = "192.168.43.206:3000"

    	function register(){
				var form = new FormData();
				// ############## aqui falta que las personas den un email para crear perfil #############
				form.append("user[email]", $("#email").val());
				form.append("user[password]", "asdasd123");
				form.append("user[password_confirmation]", "asdasd123");

				var settings = {
				  "async": true,
				  "crossDomain": true,
				  "url": "http://"+url_server+"/register",
				  "method": "POST",
				  xhrFields: {
				    withCredentials: true
				  },
				  "headers": {
				    "cache-control": "no-cache",
				    "postman-token": "6929ffa6-6171-2dfa-13b0-19fcaafe723b"
				  },
				  "processData": false,
				  "contentType": false,
				  "mimeType": "multipart/form-data",
				  "data": form,
				  error: function(resp, status){
				  	// console.log(resp);
			    	console.log("error al logearse");
			    	alert("Error, por favor comprueba tu conexión")
				  }
				}

				$.ajax(settings).done(function (response) {
				  console.log(response);
				  add_new_familiar();
				});
    	}

    	function add_new_familiar(){
    		var form = new FormData();
				form.append("family[name]", $("#name").val());

				var settings = {
				  "async": true,
				  "crossDomain": true,
				  "url": "http://"+url_server+"/families",
				  "method": "POST",
				  xhrFields: {
				    withCredentials: true
				  },
				  "headers": {
				    "cache-control": "no-cache",
				    "postman-token": "880451d2-bb70-c49a-a2a2-bdea0c3d7827"
				  },
				  "processData": false,
				  "contentType": false,
				  "mimeType": "multipart/form-data",
				  "data": form,
				  error: function(resp, status){
				  	// console.log(resp);
			    	console.log("Error al agregar familiar");
			    	alert("Error, por favor comprueba tu conexión")
				  }
				}

				$.ajax(settings).done(function (response) {
				  console.log(response);
				  window.location = "perfil.html";
				});
    	}

      // ################# se va a necesitar cuando se presione "Crear" ######################
      // function go_profile(){
        // window.location = "perfil.html";
      // }
      // ################# se va a necesitar cuando se presione "Crear" ######################

			var foto_de_perfil = "http://"+url_server+response.user.avatar_file_name

      
    </script>
</head>

<body>

<nav class="navbar">
  <div class="container-fluid">
    <ul class="nav navbar-nav">
    <!-- <li><a class="back-button" onClick="go_main_menu()">
        <span class="back-button-glyphicon glyphicon glyphicon-arrow-left aria-hidden="true"></span></a></li> -->
    <li><p class="navbar-text">CREAR PERFIL</p></li>
    </ul>
  </div>
</nav>

<!-- <div class="perfil-img">
	<img  src="img/default_avatar.png" alt="..." class="img-circle">
	<a href="" data-toggle="modal" data-target="#foto-perfil-modal" ><span class="glyphicon glyphicon-camera aria-hidden="true"></span></a>
</div> -->
<div class="intolerance-wrap">

          <form class="form-horizontal">
                <div class="form-group">
                    <label for="text" class="col-sm-2 control-label">Nombre</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="name" placeholder="Nombre">
                    </div>
                </div>
                <div class="form-group">
                    <label for="text" class="col-sm-2 control-label">Email</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="email" placeholder="Nombre">
                    </div>
                </div>
                <div class="form-group">
                  <label for="text" class="col-sm-2 control-label">Intolerancias</label>
                  <div class="col-sm-10">

                    <div class="btn-group-vertical btn-add-intolerances" data-toggle="buttons">
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/1.png" alt="..."> Gluten
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/2.png" alt="..."> Maní
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/3.png" alt="..."> Nueces
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/11.png" alt="..."> Apio
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/13.png" alt="..."> Mostaza
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/4.png" alt="..."> Huevo
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/8.png" alt="..."> Sesamo
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/12.png" alt="..."> Pescado
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/14.png" alt="..."> Crustaceos
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/5.png" alt="..."> Mariscos
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/7.png" alt="..."> Soya
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/9.png" alt="..."> Sulfitos
                      </label>
                      <label class="intolerance btn btn-default btn-lg">
                        <input type="checkbox" autocomplete="off"> <img src="img/intolerancias/1.png" alt="..."> Lupino
                      </label>
                    </div>
                  </div>
                </div>
                 <div class="form-group">
                  <div class="col-sm-offset-2 col-sm-10">
                    <button type="button" onClick="register()" class="btn btn-success">Crear</button>
                  </div>
                </div>
          </form>

</div>



    <!-- Modal Foto-->
<!--     <div class="modal fade" id="foto-perfil-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Seleccionar foto de perfil</h4>
          </div>
          <div class="modal-body">
              <form class="form-horizontal">
                <div class="form-group">
				    <label for="InputFile" class="col-sm-2 control-label">Foto</label>
				    <div class="col-sm-10">
				    <input type="file" id="InputFile">
				    <p class="help-block">Seleccione una imagen guardada en su dispositivo.</p>
				    </div>
				</div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            <button type="button" class="btn btn-primary">Guardar</button>
          </div>
          </form>
        </div>
      </div>
   </div> -->

      
</body>
</html>